import{d as H,r as l,a as R,j as e,m}from"./index-DlEiKHF4.js";const K=()=>{var U,_;const c=H(),d=((U=c==null?void 0:c.state)==null?void 0:U.mode)||"create",i=((_=c==null?void 0:c.state)==null?void 0:_.testId)||null,[x,D]=l.useState(!1),[g,E]=l.useState(!1),[z,G]=l.useState(d==="edit"),u=R(),[A,b]=l.useState(""),[M,h]=l.useState(""),[$,p]=l.useState(""),[f,y]=l.useState(""),[j,k]=l.useState(""),[I,v]=l.useState(""),[q,w]=l.useState(""),[F,N]=l.useState(""),[L,T]=l.useState(""),[P,C]=l.useState("");l.useEffect(()=>{(async()=>{var o,a,n;if(d==="edit"&&i)try{const s=await m.get("http://localhost:8002/admin/show-test",{params:{testId:i}}),r=(o=s==null?void 0:s.data)==null?void 0:o.data;r&&(b(r.title||""),h(r.description||""),p(r.duration||""),y(r.totalMarks||""),k(r.passingMarks||""),v(r.type||""),w(r.difficulty||""),N(r.version||""),T(((a=r.domain)==null?void 0:a.map(S=>S.name).join(","))||""),C(((n=r.tags)==null?void 0:n.map(S=>S.name).join(","))||""),D(r.isAttemptable))}catch(s){console.error("Failed to fetch test data",s),alert("Failed to load test data")}finally{G(!1)}})()},[d,i]);const Q=async t=>{var a,n;if(t.preventDefault(),Number(j)>=Number(f)){alert("Passing marks must be less than total marks.");return}const o={testId:i,title:A,description:M,duration:$,totalMarks:f,passingMarks:j,type:I,difficulty:q,version:F,domain:L.split(",").map(s=>s.trim()),tags:P.split(",").map(s=>s.trim())};try{let s;d==="edit"?s=await m.put("http://localhost:8002/admin/update-test",o,{headers:{"Content-Type":"application/json"}}):s=await m.post("http://localhost:8002/admin/create-test",o,{headers:{"Content-Type":"application/json"}}),(s==null?void 0:s.status)===200||(s==null?void 0:s.status)===201?(alert(d==="edit"?"Test Updated Successfully!":"Test Created Successfully!"),localStorage.setItem("testId",((n=(a=s==null?void 0:s.data)==null?void 0:a.data)==null?void 0:n.id)||i),d!=="edit"&&(b(""),h(""),p(""),y(""),k(""),v(""),w(""),N(""),T(""),C(""))):alert("Failed to save test")}catch(s){console.error("Error:",s),alert("Something went wrong saving the test!")}},V=async()=>{try{(await m.delete(`http://localhost:8002/admin/delete-test?testId=${i}`)).status===200?(alert("Test Deleted Successfully!"),u(-1)):alert("Failed to delete test")}catch(t){console.error("Error deleting test:",t),alert("Something went wrong!")}},B=async()=>{var t,o;if(!(g||!i)&&!(x&&!window.confirm("This test is currently assignable. Are you sure you want to toggle it?"))){E(!0);try{const a=await m.get("http://localhost:8002/admin/toggle-testAssignability",{params:{testId:i}});if((t=a==null?void 0:a.data)!=null&&t.success){const n=(o=a.data.data)==null?void 0:o.isAttemptable;D(n),alert(a.data.message||"Assignability toggled successfully!")}else alert(a.data.message||"Failed to toggle assignability.")}catch(a){console.error("Toggle Assignability failed:",a),alert("Something went wrong while toggling assignability.")}finally{E(!1)}}};return e.jsxs("div",{className:"max-w-4xl mx-auto bg-white dark:bg-slate-900 shadow-md rounded-lg p-6 md:p-10 space-y-6 drop-shadow-[2px_2px_2px_rgba(0,0,0,0.6)]",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("button",{type:"button",onClick:()=>u(-1),className:"text-sm text-blue-600 font-semibold hover:underline",children:"← Go Back"}),e.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-slate-800 dark:text-white text-center flex-1",children:d==="edit"?"Update Test":"Create Test"}),d==="edit"?e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"checkbox",className:"sr-only",checked:x,onChange:B,disabled:g}),e.jsx("div",{className:`w-11 h-6 rounded-full shadow-inner transition duration-300 ${x?"bg-blue-600":"bg-gray-600"} ${g?"opacity-50 cursor-not-allowed":""}`}),e.jsx("div",{className:`dot absolute left-1 top-1 bg-white w-4 h-4 rounded-full transition ${x?"translate-x-5":""}`})]}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:g?"Toggling...":"Toggle Assign"})]}):e.jsx("div",{className:"w-[150px]"})]}),e.jsxs("form",{onSubmit:Q,className:"grid gap-6",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-semibold text-slate-700 dark:text-slate-200 mb-1",children:"Title"}),e.jsx("input",{type:"text",className:"px-4 py-2 border border-gray-300 dark:border-slate-700 rounded-md bg-white dark:bg-slate-800 text-slate-900 dark:text-white",placeholder:"Enter test title",value:A,onChange:t=>b(t.target.value),required:!0})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-semibold text-slate-700 dark:text-slate-200 mb-1",children:"Description"}),e.jsx("input",{type:"text",className:"px-4 py-2 border border-gray-300 dark:border-slate-700 rounded-md bg-white dark:bg-slate-800 text-slate-900 dark:text-white",placeholder:"Enter test description",value:M,onChange:t=>h(t.target.value)})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-semibold text-slate-700 dark:text-slate-200 mb-1",children:"Duration (minutes)"}),e.jsx("input",{type:"number",min:"0",className:"px-4 py-2 border border-gray-300 dark:border-slate-700 rounded-md bg-white dark:bg-slate-800 text-slate-900 dark:text-white",placeholder:"Enter duration",value:$,onChange:t=>p(t.target.value),required:!0})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-semibold text-slate-700 dark:text-slate-200 mb-1",children:"Test Type"}),e.jsx("input",{type:"text",className:"px-4 py-2 border border-gray-300 dark:border-slate-700 rounded-md bg-white dark:bg-slate-800 text-slate-900 dark:text-white",placeholder:"Enter test type...",value:I,onChange:t=>v(t.target.value),required:!0})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-semibold text-slate-700 dark:text-slate-200 mb-1",children:"Total Marks"}),e.jsx("input",{type:"number",min:"0",className:"px-4 py-2 border border-gray-300 dark:border-slate-700 rounded-md bg-white dark:bg-slate-800 text-slate-900 dark:text-white",placeholder:"Enter total marks",value:f,onChange:t=>y(t.target.value),required:!0})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-semibold text-slate-700 dark:text-slate-200 mb-1",children:"Passing Marks"}),e.jsx("input",{type:"number",min:"0",className:"px-4 py-2 border border-gray-300 dark:border-slate-700 rounded-md bg-white dark:bg-slate-800 text-slate-900 dark:text-white",placeholder:"Enter passing marks",value:j,onChange:t=>k(t.target.value),required:!0})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-semibold text-slate-700 dark:text-slate-200 mb-1",children:"Difficulty"}),e.jsx("input",{type:"text",className:"px-4 py-2 border border-gray-300 dark:border-slate-700 rounded-md bg-white dark:bg-slate-800 text-slate-900 dark:text-white",placeholder:"e.g., Easy, Medium, Hard",value:q,onChange:t=>w(t.target.value)})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-semibold text-slate-700 dark:text-slate-200 mb-1",children:"Version"}),e.jsx("input",{type:"text",className:"px-4 py-2 border border-gray-300 dark:border-slate-700 rounded-md bg-white dark:bg-slate-800 text-slate-900 dark:text-white",placeholder:"Enter version number",value:F,onChange:t=>N(t.target.value)})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-semibold text-slate-700 dark:text-slate-200 mb-1",children:"Domain"}),e.jsx("input",{type:"text",className:"px-4 py-2 border border-gray-300 dark:border-slate-700 rounded-md bg-white dark:bg-slate-800 text-slate-900 dark:text-white",placeholder:"Comma-separated e.g., Personality,Dummy,Test",value:L,onChange:t=>T(t.target.value)})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-semibold text-slate-700 dark:text-slate-200 mb-1",children:"Tags"}),e.jsx("input",{type:"text",className:"px-4 py-2 border border-gray-300 dark:border-slate-700 rounded-md bg-white dark:bg-slate-800 text-slate-900 dark:text-white",placeholder:"Comma-separated e.g., General,testing,tryout",value:P,onChange:t=>C(t.target.value)})]})]}),d==="edit"?e.jsxs("div",{className:"flex justify-between pt-4 items-center",children:[e.jsx("button",{type:"button",onClick:V,className:"px-4 py-2 bg-red-500 text-white font-semibold rounded-md hover:bg-red-600 transition",children:"Delete Test"}),e.jsx("button",{type:"submit",className:"px-6 py-2 bg-green-500 text-white font-semibold rounded-md hover:bg-green-600 transition",children:"Update Test"}),e.jsx("button",{type:"button",onClick:()=>u("/admin/showallQuesadmin",{state:{id:i}}),className:"px-4 py-2 bg-blue-600 text-white font-semibold rounded-md hover:bg-blue-700 transition",children:"Edit Questions"})]}):e.jsx("div",{className:"flex justify-center pt-4",children:e.jsx("button",{type:"submit",className:"px-6 py-2 bg-red-600 text-white font-semibold rounded-md hover:bg-red-700 transition",children:"Save Test"})})]})]})};export{K as default};
