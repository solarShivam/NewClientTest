import{r as m,d as _,a as A,j as t,v as E,w as C,m as x}from"./index-DlEiKHF4.js";import{C as k}from"./circle-x-CrLFNGj1.js";const $=()=>{var g,f,b;const[s,c]=m.useState(null),n=_(),l=A(),w=async e=>{var a,i;try{const o=await x.get(`http://localhost:8002/admin/show-test?testId=${e}`);(a=o==null?void 0:o.data)!=null&&a.success?c((i=o==null?void 0:o.data)==null?void 0:i.data):alert("Test not found!")}catch(o){console.error("Error fetching test data:",o),alert("Error fetching test data.")}};m.useEffect(()=>{var e;(e=n.state)!=null&&e.id&&w(n.state.id)},[(g=n.state)==null?void 0:g.id]);const j=async e=>{if(window.confirm("Are you sure you want to delete this question?"))try{(await x.delete("http://localhost:8002/admin/delete-question",{params:{quesId:e}})).data.success?(alert("Question deleted successfully!"),c(i=>({...i,questions:i.questions.filter(o=>o.id!==e)}))):alert("Failed to delete the question.")}catch(a){console.error("Error deleting question:",a),alert("Something went wrong while deleting!")}},h=e=>e&&(e.startsWith("http://88.222.214.93:8003")?e.replace("http://88.222.214.93:8003","https://testportal.galosolar.com"):e);m.useEffect(()=>{console.log("my question show to admin ---------------",s==null?void 0:s.questions)},[s]);const y=()=>{l(-1)},u=async e=>{var a;try{const i=await x.get(`http://localhost:8002/admin/toggle-questionActivation?quesId=${e}`);(a=i==null?void 0:i.data)!=null&&a.success?(alert("Question Toggle SuccessFully"),c(o=>({...o,questions:o.questions.map(r=>r.id===e?{...r,isActive:!r.isActive}:r)}))):alert("Failed to toggle question status.")}catch(i){console.error("Toggle error:",i),alert("Error toggling question activation.")}},v=e=>{e&&u(e)};return t.jsxs("div",{className:"w-full h-screen flex flex-col bg-gray-100",children:[t.jsxs("div",{className:"sticky top-0 bg-gray-100 shadow-md px-2 py-3 z-10",children:[t.jsxs("h1",{className:"text-2xl font-bold  text-center drop-shadow-[2px_2px_2px_rgba(0,0,0,0.6)]",children:["Edit Questions"," ",t.jsxs("span",{className:"text-sm drop-shadow-[2px_2px_2px_rgba(0,0,0,0.6)]",children:["for ",(s==null?void 0:s.title)||"Saved Test Name"]})]}),t.jsxs("h2",{className:"text-lg font-semibold drop-shadow-[2px_2px_2px_rgba(0,0,0,0.6)]",children:["Total Questions: ",((f=s==null?void 0:s.questions)==null?void 0:f.length)||0]})]}),t.jsx("div",{className:"flex-grow  space-y-4",children:(b=s==null?void 0:s.questions)==null?void 0:b.map((e,a)=>{var i,o,r;return t.jsxs("div",{className:`relative group p-4 rounded-lg shadow-md border flex flex-col md:flex-row justify-between ${e.isActive?"bg-white":"opacity-50 blur-sm hover:blur-none transition"}`,children:[!e.isActive&&t.jsx("div",{className:"absolute inset-0 flex justify-center items-center z-10 bg-white/30 group-hover:bg-white/50",children:t.jsx(k,{onClick:()=>v(e.id),className:"text-red-600 w-12 h-12 opacity-0 group-hover:opacity-100 transition cursor-pointer"})}),t.jsxs("div",{children:[t.jsxs("p",{className:"font-semibold whitespace-pre-line",children:["Q.",a+1," ",(i=e==null?void 0:e.problemStatement)==null?void 0:i.replace(/\r\n/g,`
`)]}),(e==null?void 0:e.problemImageUrl)&&t.jsx("img",{src:h(e==null?void 0:e.problemImageUrl),alt:"Problem",className:"mt-2 w-auto h-40 rounded-md"}),t.jsx("ul",{className:"list-none ml-4 mt-2",children:(o=Object==null?void 0:Object.entries(e==null?void 0:e.options))==null?void 0:o.map(([d,p])=>{const N=p.match(/\.(jpeg|jpg|gif|png|webp)$/i);return t.jsxs("li",{className:"text-gray-600 flex items-center space-x-2",children:[t.jsxs("span",{className:"font-semibold",children:[d,"."]}),N?t.jsx("img",{src:h(p),alt:`Option ${d}`,className:"w-auto h-40 rounded-md"}):t.jsx("span",{children:p})]},d)})}),t.jsxs("p",{className:"text-gray-700 mt-2 font-semibold",children:["Correct Answer: ",(r=e==null?void 0:e.correctOption)==null?void 0:r.toUpperCase()]})]}),t.jsxs("div",{className:"flex flex-col space-y-2 items-start mt-4 md:mt-0",children:[t.jsxs("button",{onClick:()=>l("/createquestion",{state:{questionId:e.id,testIdForUp:e.testId,mode:"Edit"}}),className:"p-2 text-blue-600 hover:text-blue-800 flex items-center space-x-1",children:[t.jsx(E,{size:20}),t.jsx("span",{children:"Edit"})]}),t.jsxs("button",{onClick:()=>j(e==null?void 0:e.id),className:"p-2 text-red-600 hover:text-red-800 flex items-center space-x-1",children:[t.jsx(C,{size:20}),t.jsx("span",{children:"Delete"})]}),t.jsxs("button",{onClick:()=>u(e==null?void 0:e.id),className:"p-2 text-green-600 hover:text-green-800 flex items-center space-x-1",children:[t.jsx("span",{className:`w-4 h-4 rounded-full ${e.isActive?"bg-green-500":"bg-gray-400"}`}),t.jsx("span",{children:e.isActive?"Active":"Inactive"})]})]})]},e==null?void 0:e.id)})}),t.jsxs("div",{className:"sticky bottom-0 bg-gray-100 shadow-md px-2 py-3 flex justify-between",children:[t.jsx("button",{onClick:y,className:"bg-yellow-500  font-semibold px-6 py-2 rounded-md hover:bg-yellow-600 transition drop-shadow-[2px_2px_2px_rgba(0,0,0,0.6)]",children:"Go Back"}),t.jsx("button",{onClick:()=>l("/admin/uploadquestion",{state:{testId:s==null?void 0:s.id}}),className:"bg-yellow-500  font-semibold px-6 py-2 rounded-md hover:bg-yellow-600 transition drop-shadow-[2px_2px_2px_rgba(0,0,0,0.6)]",children:"Upload"}),t.jsx("button",{onClick:()=>{var e;return l("/admin/createquestion",{state:{testId:(e=n.state)==null?void 0:e.id,type:s.type}})},className:"bg-yellow-500  font-semibold px-6 py-2 rounded-md hover:bg-yellow-600 transition drop-shadow-[2px_2px_2px_rgba(0,0,0,0.6)]",children:"Add Question"})]})]})};export{$ as default};
