import{r as x,d as _,a as A,j as s,v as E,w as C,m as p}from"./index-D9x9yDo8.js";import{C as k}from"./circle-x-DGGEiqch.js";const $=()=>{var g,f,b;const[t,c]=x.useState(null),r=_(),l=A(),w=async e=>{var a,i;try{const o=await p.get(`undefined/admin/show-test?testId=${e}`);(a=o==null?void 0:o.data)!=null&&a.success?c((i=o==null?void 0:o.data)==null?void 0:i.data):alert("Test not found!")}catch(o){console.error("Error fetching test data:",o),alert("Error fetching test data.")}};x.useEffect(()=>{var e;(e=r.state)!=null&&e.id&&w(r.state.id)},[(g=r.state)==null?void 0:g.id]);const j=async e=>{if(window.confirm("Are you sure you want to delete this question?"))try{(await p.delete("undefined/admin/delete-question",{params:{quesId:e}})).data.success?(alert("Question deleted successfully!"),c(i=>({...i,questions:i.questions.filter(o=>o.id!==e)}))):alert("Failed to delete the question.")}catch(a){console.error("Error deleting question:",a),alert("Something went wrong while deleting!")}},h=e=>e&&(e.startsWith("http://88.222.214.93:8003")?e.replace("http://88.222.214.93:8003","https://testportal.galosolar.com"):e);x.useEffect(()=>{console.log("my question show to admin ---------------",t==null?void 0:t.questions)},[t]);const y=()=>{l(-1)},u=async e=>{var a;try{const i=await p.get(`undefined/admin/toggle-questionActivation?quesId=${e}`);(a=i==null?void 0:i.data)!=null&&a.success?(alert("Question Toggle SuccessFully"),c(o=>({...o,questions:o.questions.map(n=>n.id===e?{...n,isActive:!n.isActive}:n)}))):alert("Failed to toggle question status.")}catch(i){console.error("Toggle error:",i),alert("Error toggling question activation.")}},v=e=>{e&&u(e)};return s.jsxs("div",{className:"w-full h-screen flex flex-col bg-gray-100",children:[s.jsxs("div",{className:"sticky top-0 bg-gray-100 shadow-md px-2 py-3 z-10",children:[s.jsxs("h1",{className:"text-2xl font-bold  text-center drop-shadow-[2px_2px_2px_rgba(0,0,0,0.6)]",children:["Edit Questions"," ",s.jsxs("span",{className:"text-sm drop-shadow-[2px_2px_2px_rgba(0,0,0,0.6)]",children:["for ",(t==null?void 0:t.title)||"Saved Test Name"]})]}),s.jsxs("h2",{className:"text-lg font-semibold drop-shadow-[2px_2px_2px_rgba(0,0,0,0.6)]",children:["Total Questions: ",((f=t==null?void 0:t.questions)==null?void 0:f.length)||0]})]}),s.jsx("div",{className:"flex-grow  space-y-4",children:(b=t==null?void 0:t.questions)==null?void 0:b.map((e,a)=>{var i,o,n;return s.jsxs("div",{className:`relative group p-4 rounded-lg shadow-md border flex flex-col md:flex-row justify-between ${e.isActive?"bg-white":"opacity-50 blur-sm hover:blur-none transition"}`,children:[!e.isActive&&s.jsx("div",{className:"absolute inset-0 flex justify-center items-center z-10 bg-white/30 group-hover:bg-white/50",children:s.jsx(k,{onClick:()=>v(e.id),className:"text-red-600 w-12 h-12 opacity-0 group-hover:opacity-100 transition cursor-pointer"})}),s.jsxs("div",{children:[s.jsxs("p",{className:"font-semibold whitespace-pre-line",children:["Q.",a+1," ",(i=e==null?void 0:e.problemStatement)==null?void 0:i.replace(/\r\n/g,`
`)]}),(e==null?void 0:e.problemImageUrl)&&s.jsx("img",{src:h(e==null?void 0:e.problemImageUrl),alt:"Problem",className:"mt-2 w-auto h-40 rounded-md"}),s.jsx("ul",{className:"list-none ml-4 mt-2",children:(o=Object==null?void 0:Object.entries(e==null?void 0:e.options))==null?void 0:o.map(([d,m])=>{const N=m.match(/\.(jpeg|jpg|gif|png|webp)$/i);return s.jsxs("li",{className:"text-gray-600 flex items-center space-x-2",children:[s.jsxs("span",{className:"font-semibold",children:[d,"."]}),N?s.jsx("img",{src:h(m),alt:`Option ${d}`,className:"w-auto h-40 rounded-md"}):s.jsx("span",{children:m})]},d)})}),s.jsxs("p",{className:"text-gray-700 mt-2 font-semibold",children:["Correct Answer: ",(n=e==null?void 0:e.correctOption)==null?void 0:n.toUpperCase()]})]}),s.jsxs("div",{className:"flex flex-col space-y-2 items-start mt-4 md:mt-0",children:[s.jsxs("button",{onClick:()=>l("/createquestion",{state:{questionId:e.id,testIdForUp:e.testId,mode:"Edit"}}),className:"p-2 text-blue-600 hover:text-blue-800 flex items-center space-x-1",children:[s.jsx(E,{size:20}),s.jsx("span",{children:"Edit"})]}),s.jsxs("button",{onClick:()=>j(e==null?void 0:e.id),className:"p-2 text-red-600 hover:text-red-800 flex items-center space-x-1",children:[s.jsx(C,{size:20}),s.jsx("span",{children:"Delete"})]}),s.jsxs("button",{onClick:()=>u(e==null?void 0:e.id),className:"p-2 text-green-600 hover:text-green-800 flex items-center space-x-1",children:[s.jsx("span",{className:`w-4 h-4 rounded-full ${e.isActive?"bg-green-500":"bg-gray-400"}`}),s.jsx("span",{children:e.isActive?"Active":"Inactive"})]})]})]},e==null?void 0:e.id)})}),s.jsxs("div",{className:"sticky bottom-0 bg-gray-100 shadow-md px-2 py-3 flex justify-between",children:[s.jsx("button",{onClick:y,className:"bg-yellow-500  font-semibold px-6 py-2 rounded-md hover:bg-yellow-600 transition drop-shadow-[2px_2px_2px_rgba(0,0,0,0.6)]",children:"Go Back"}),s.jsx("button",{onClick:()=>l("/admin/uploadquestion",{state:{testId:t==null?void 0:t.id}}),className:"bg-yellow-500  font-semibold px-6 py-2 rounded-md hover:bg-yellow-600 transition drop-shadow-[2px_2px_2px_rgba(0,0,0,0.6)]",children:"Upload"}),s.jsx("button",{onClick:()=>{var e;return l("/admin/createquestion",{state:{testId:(e=r.state)==null?void 0:e.id,type:t.type}})},className:"bg-yellow-500  font-semibold px-6 py-2 rounded-md hover:bg-yellow-600 transition drop-shadow-[2px_2px_2px_rgba(0,0,0,0.6)]",children:"Add Question"})]})]})};export{$ as default};
